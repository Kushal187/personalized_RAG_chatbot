services:
  - type: web
    name: resumeai-backend
    env: python
    rootDir: backend
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: OPENAI_API_KEY
        sync: false
      - key: TARGET_PERSON
        value: Sanjeev Kushal Pendekanti
      - key: DATA_DIR
        value: /var/data
      - key: CORS_ORIGINS
        value: https://resumeai-frontend.onrender.com,http://localhost:5173
      - key: EMBED_MODEL
        value: text-embedding-3-small
      - key: ANSWER_MODEL
        value: gpt-4o-mini
      - key: EXTRACTION_MODEL
        value: gpt-4o-mini
    disks:
      - name: resumeai-data
        mountPath: /var/data
        sizeGB: 1

  - type: static
    name: resumeai-frontend
    rootDir: frontend
    buildCommand: npm ci && npm run build
    staticPublishPath: dist
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
    envVars:
      - key: VITE_API_BASE_URL
        value: https://resumeai-backend.onrender.com
